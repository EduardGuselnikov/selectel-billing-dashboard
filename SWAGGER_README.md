# Selectel Billing API Documentation

## üìñ –û –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã Selectel Billing, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ ETL —Å–∏—Å—Ç–µ–º–µ –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ:
- –ë–∞–ª–∞–Ω—Å–∞—Ö –∞–∫–∫–∞—É–Ω—Ç–∞
- –ü—Ä–æ–≥–Ω–æ–∑–∞—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤
- –ò—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –û—Ç—á–µ—Ç–∞—Ö –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º

## üåê –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: Swagger UI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `swagger.html` –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:

```bash
# Linux/macOS
open swagger.html

# Windows
start swagger.html
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–Ω–ª–∞–π–Ω —Ä–µ–¥–∞–∫—Ç–æ—Ä
1. –û—Ç–∫—Ä–æ–π—Ç–µ [Swagger Editor](https://editor.swagger.io/)
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `swagger.yaml`
3. –í—Å—Ç–∞–≤—å—Ç–µ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä

### –í–∞—Ä–∏–∞–Ω—Ç 3: VS Code
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ "Swagger Viewer" –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ `swagger.yaml`

## üîë –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í—Å–µ API –∑–∞–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫:
```
X-Token: YOUR_API_TOKEN
```

–ü–æ–ª—É—á–∏—Ç—å API —Ç–æ–∫–µ–Ω –º–æ–∂–Ω–æ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ Selectel.

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ß–∞—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è |
|----------|----------|----------------------|
| `GET /v3/balances` | –¢–µ–∫—É—â–∏–µ –±–∞–ª–∞–Ω—Å—ã | –ö–∞–∂–¥—ã–π —á–∞—Å |
| `GET /v2/billing/prediction` | –ü—Ä–æ–≥–Ω–æ–∑—ã —Ä–∞—Å—Ö–æ–¥–æ–≤ | –ö–∞–∂–¥—ã–π —á–∞—Å |
| `GET /v2/billing/transactions` | –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π | –ö–∞–∂–¥—ã–π —á–∞—Å (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —á–∞—Å–∞) |
| `GET /v1/billing/report/by_project/detailed` | –û—Ç—á–µ—Ç—ã –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ (—Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü) |

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ —Ñ–∞–π–ª–µ `selectel_etl.py`:

- `fetch_balances()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/v3/balances`
- `fetch_predictions()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/v2/billing/prediction`
- `fetch_transactions()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/v2/billing/transactions`
- `fetch_project_reports()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/v1/billing/report/by_project/detailed`

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### –ë–∞–ª–∞–Ω—Å—ã
```json
{
  "balance_id": "12345",
  "balance_type": "main",
  "value": 150000
}
```

### –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
```json
{
  "id_meta": {"id": [687288652]},
  "transaction_type": "withdraw",
  "balance": "bonus",
  "price": -20943,
  "created": "2025-09-11T00:40:27.572253"
}
```

### –ü—Ä–æ–µ–∫—Ç—ã
```json
{
  "id": "038f673576ec46b2849a8bc3411d194e",
  "name": "E-learn_",
  "paid_by_balance": [
    {"balance": "main", "value": 16397012},
    {"balance": "bonus", "value": 80761}
  ]
}
```

## ‚ùó –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–õ–∏–º–∏—Ç—ã**: –ü–∞—Ä–∞–º–µ—Ç—Ä `limit` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è `/v2/billing/transactions` (–º–∞–∫—Å–∏–º—É–º 500)
2. **–î–∞—Ç—ã**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç ISO 8601 (`2025-09-11T00:00:00`)
3. **–ü–∞–≥–∏–Ω–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `offset` –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö
4. **–û—à–∏–±–∫–∏**: API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å `error` –≤ —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Selectel API Documentation](https://selectel.ru/api/)
- [OpenAPI Specification](https://spec.openapis.org/oas/v3.0.3)
- [Swagger UI](https://swagger.io/tools/swagger-ui/)
